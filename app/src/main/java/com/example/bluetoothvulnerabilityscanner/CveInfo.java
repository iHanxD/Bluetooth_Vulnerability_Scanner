package com.example.bluetoothvulnerabilityscanner;

import androidx.annotation.NonNull;
import androidx.appcompat.app.AppCompatActivity;

import android.os.Bundle;
import android.util.Log;
import android.widget.TextView;

import com.google.firebase.database.DataSnapshot;
import com.google.firebase.database.DatabaseError;
import com.google.firebase.database.DatabaseReference;
import com.google.firebase.database.FirebaseDatabase;
import com.google.firebase.database.ValueEventListener;
import com.ms.square.android.expandabletextview.ExpandableTextView;

public class CveInfo extends AppCompatActivity {


    private static final String TAG = "Build";

    public static final String cveName = "CVE-2017-13172";


    //Database link instance
    FirebaseDatabase database = FirebaseDatabase.getInstance("https://bluetoothvulnscannerdb-default-rtdb.asia-southeast1.firebasedatabase.app");

    //Database references
    DatabaseReference cveDescription = database.getReference("CVE/"+cveName+"/Vulnerability Description");
    DatabaseReference cveBaseScore = database.getReference("CVE/"+cveName+"/CVSS/Base Score");
    DatabaseReference cveVector = database.getReference("CVE/"+cveName+"/CVSS/Vector");



    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_cve_info);

        //defining of textViews
        TextView cveNameTextView = (TextView) findViewById(R.id.cveName);
        TextView cveBaseScoreTextView = (TextView) findViewById(R.id.baseScoreValue);
        TextView cveVectorTextView = (TextView) findViewById(R.id.vectorValue);
        ExpandableTextView descriptionTextView = (ExpandableTextView) findViewById(R.id.description_expandable_text_view);
        ExpandableTextView iocTextView = (ExpandableTextView) findViewById(R.id.ioc_expandable_text_view);
        ExpandableTextView referencesTextView = (ExpandableTextView) findViewById(R.id.references_expandable_text_view);


        //setting of variables
        cveNameTextView.setText(cveName);


        cveDescription.addValueEventListener(new ValueEventListener() {
            @Override
            public void onDataChange(@NonNull DataSnapshot snapshot) {
                String cveDescriptionValue=snapshot.getValue(String.class);
                Log.d(TAG, "Description value is: " + cveDescriptionValue);
                descriptionTextView.setText(cveDescriptionValue);
            }

            @Override
            public void onCancelled(@NonNull DatabaseError error) {
                // Failed to read description value
                Log.w(TAG, "Failed to read description value.", error.toException());

            }
        });

        cveBaseScore.addValueEventListener(new ValueEventListener() {
            @Override
            public void onDataChange(@NonNull DataSnapshot snapshot) {
                String cveBaseScoreValue=snapshot.getValue(String.class);
                Log.d(TAG, "Base Score value is: " + cveBaseScoreValue);
                cveBaseScoreTextView.setText(cveBaseScoreValue);
            }

            @Override
            public void onCancelled(@NonNull DatabaseError error) {
                // Failed to read description value
                Log.w(TAG, "Failed to read Base Score value.", error.toException());

            }
        });


        cveVector.addValueEventListener(new ValueEventListener() {
            @Override
            public void onDataChange(@NonNull DataSnapshot snapshot) {
                String cveVectorValue=snapshot.getValue(String.class);
                Log.d(TAG, "cve vector value is: " + cveVectorValue);
                cveVectorTextView.setText(cveVectorValue);
            }

            @Override
            public void onCancelled(@NonNull DatabaseError error) {
                // Failed to read description value
                Log.w(TAG, "Failed to read cve vector value.", error.toException());

            }
        });






        iocTextView.setText("Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book. It has survived not only five centuries, but also the leap into electronic typesetting, remaining essentially unchanged. It was popularised in the 1960s with the release of Letraset sheets containing Lorem Ipsum passages, and more recently with desktop publishing software like Aldus PageMaker including versions of Lorem Ipsum.");
        referencesTextView.setText("Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book. It has survived not only five centuries, but also the leap into electronic typesetting, remaining essentially unchanged. It was popularised in the 1960s with the release of Letraset sheets containing Lorem Ipsum passages, and more recently with desktop publishing software like Aldus PageMaker including versions of Lorem Ipsum.");
    }
}